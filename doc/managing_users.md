Managing Users
==============
Genomic Status reads stored users from the "gs_users" database on the couch_server. 
The current system is not intended to be a temporary solution and is intended to
operate behind a firewall. Users has to be manually added as documents with keys 
"username" and "password_hash" defined. This will not scale at all, but is a 
reasonably safe solution while staying behind the firewall, denying almost all
outside connections.

Besides the administrative demands, this solution has security issues:

  - No password salt is used, should be randomly generated for each user.
  - The hashing algorithm used is not inteneded for password authentication.
 

Generating Password Hashes
--------------------------
The following code can be used to generate the password hash given the password and the seed:

    #!/usr/bin/env python
    password = "secret_1"
    seed = "Rey1zu^r0vv^(Qf" # Random string, can be generated by os.urandom(15)
    import hashlib
    password_hash = hashlib.sha256(seed + password).hexdigest()
    print password_hash

All passwords in the database need to be generated with the seed given in the 
"settings.yaml" file. The motivation to have both a hashed password and a seed
 is that even if the hashed password is compromised, the original passphrase 
is still very hard to reconstruct.

How Authentication Works
------------------------
Any resource handler that needs to be secured should inherit SafeHandler 
located in status/util.py. This ensures that the user is logged in by 
checking that the 'get_current_user' method, defined in the BaseHandler
class, does not return None. If someone tries to reach a secured resource
without being logged in, the server will redirect to the login url, 
handled by the LoginHandler. When the user logs in, the credentials
are checked against the database and if everything is correct, an encrypted 
cookie named user is created and in it, the user name. This cookie is used
by the 'get_current_user' method. The cookie is called a secure cookie since it
is encrypted, and if the correct encryption secret was not used to create
the cookie, the 'get_current_user' method will return None, as if no user
was logged in. During log out, the user-cookie is deleted. 
